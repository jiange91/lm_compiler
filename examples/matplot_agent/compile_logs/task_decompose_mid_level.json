{
    "initial code generation": {
        "agents": {
            "QueryInterpreter": {
                "inputs": [
                    "expanded_query"
                ],
                "outputs": [
                    "requirements"
                ],
                "prompt": "You are an expert at understanding natural language queries. Given a natural language query, identify and list all the requirements and tasks that need to be performed to generate the desired Python code. Make sure to include any specific data manipulations, plotting requirements, and file-saving instructions mentioned in the query.",
                "next_action": [
                    "CodePlanner"
                ],
                "dynamic_action_decision": "None"
            },
            "CodePlanner": {
                "inputs": [
                    "requirements"
                ],
                "outputs": [
                    "code_plan"
                ],
                "prompt": "You are an expert at planning and structuring Python code. Based on the identified requirements and tasks, create a detailed plan for the Python code. Specify which libraries to use, the sequence of operations, and any specific functions or methods that need to be implemented.",
                "next_action": [
                    "CodeGenerator"
                ],
                "dynamic_action_decision": "None"
            },
            "CodeGenerator": {
                "inputs": [
                    "code_plan",
                    "plot_file_name"
                ],
                "outputs": [
                    "code"
                ],
                "prompt": "You are an expert Python programmer. Using the detailed plan provided, write the complete Python code to satisfy all the requirements in the original query. Ensure the code is runnable and includes any necessary data manipulations, plotting, and file-saving instructions.",
                "next_action": [
                    "END"
                ],
                "dynamic_action_decision": "None"
            }
        }
    },
    "visual refine coder": {
        "agents": {
            "InstructionParser": {
                "inputs": [
                    "code",
                    "visual_refinement"
                ],
                "outputs": [
                    "changes"
                ],
                "prompt": "You are an expert at understanding natural language instructions. You will be given a piece of code and a set of instructions on how to improve it. Your task is to parse the instructions and identify the specific changes that need to be made to the code. Output a list of these changes in a clear and concise manner.",
                "next_action": [
                    "CodeModifier"
                ],
                "dynamic_action_decision": "None"
            },
            "CodeModifier": {
                "inputs": [
                    "code",
                    "changes"
                ],
                "outputs": [
                    "modified_code"
                ],
                "prompt": "You are an expert Python programmer. You will be given a piece of code and a list of specific changes that need to be made to it. Your task is to modify the code according to these changes while retaining its original functionality. Ensure that the modified code is runnable and meets all the requirements specified in the changes.",
                "next_action": [
                    "PlotSaver"
                ],
                "dynamic_action_decision": "None"
            },
            "PlotSaver": {
                "inputs": [
                    "modified_code",
                    "plot_file_name"
                ],
                "outputs": [
                    "code"
                ],
                "prompt": "You are an expert in data visualization and file handling in Python. You will be given a piece of code that generates plots. Your task is to ensure that each plot is saved to a PNG file with the given 'plot_file_name'. Modify the code to include the necessary commands to save the plots correctly.",
                "next_action": [
                    "END"
                ],
                "dynamic_action_decision": "None"
            }
        }
    },
    "plot debugger": {
        "agents": {
            "QueryAnalyzer": {
                "inputs": [
                    "query"
                ],
                "outputs": [
                    "visualization_requirements"
                ],
                "prompt": "You are an expert in understanding user queries related to data visualization. Given a user query, your task is to extract and clearly state the data visualization requirements. Focus on identifying the type of plot, data to be visualized, and any specific details mentioned by the user.",
                "next_action": [
                    "CodeAnalyzer"
                ],
                "dynamic_action_decision": "None"
            },
            "CodeAnalyzer": {
                "inputs": [
                    "code"
                ],
                "outputs": [
                    "code_summary"
                ],
                "prompt": "You are an expert in analyzing Python code for data visualization. Given a piece of existing Python code, your task is to understand its structure and functionality. Provide a summary of what the code is intended to do, including the type of plot it aims to generate and the data it uses.",
                "next_action": [
                    "ErrorIdentifier"
                ],
                "dynamic_action_decision": "None"
            },
            "ErrorIdentifier": {
                "inputs": [
                    "code",
                    "error_message"
                ],
                "outputs": [
                    "error_details"
                ],
                "prompt": "You are an expert in identifying errors in Python code. Given a piece of Python code and an associated error message, your task is to pinpoint the exact location and cause of the error. Provide a detailed explanation of the error and its root cause.",
                "next_action": [
                    "CodeDebugger"
                ],
                "dynamic_action_decision": "None"
            },
            "CodeDebugger": {
                "inputs": [
                    "query",
                    "code_summary",
                    "error_details"
                ],
                "outputs": [
                    "code"
                ],
                "prompt": "You are an expert in debugging Python code for data visualization. Given a user query, a summary of the existing code, and an identified error with its root cause, your task is to fix the error. Ensure that the corrected code is executable and can generate the required plot without any errors.",
                "next_action": [
                    "END"
                ],
                "dynamic_action_decision": "None"
            }
        }
    },
    "query expansion": {
        "agents": {
            "QueryUnderstandingAgent": {
                "inputs": [
                    "query"
                ],
                "outputs": [
                    "clarified_requirements"
                ],
                "prompt": "You are an expert at understanding user requirements. Given a user query, your task is to interpret and clarify the requirements. Break down the query into specific tasks or goals that need to be achieved to fulfill the user's request. Make sure to identify any ambiguities or assumptions that need to be addressed.",
                "next_action": [
                    "LibraryIdentificationAgent"
                ],
                "dynamic_action_decision": "None"
            },
            "LibraryIdentificationAgent": {
                "inputs": [
                    "clarified_requirements"
                ],
                "outputs": [
                    "identified_libraries"
                ],
                "prompt": "You are an expert in Python libraries. Based on the clarified requirements provided, identify all the appropriate Python libraries that are needed to fulfill the tasks. List the libraries and briefly describe their roles in the context of the tasks.",
                "next_action": [
                    "FunctionIdentificationAgent"
                ],
                "dynamic_action_decision": "None"
            },
            "FunctionIdentificationAgent": {
                "inputs": [
                    "clarified_requirements",
                    "identified_libraries"
                ],
                "outputs": [
                    "identified_functions"
                ],
                "prompt": "You are an expert in Python programming. Based on the identified libraries and the clarified requirements, pinpoint the correct library functions to call. For each function, specify the parameters that need to be set and provide a brief explanation of their roles.",
                "next_action": [
                    "DataPreparationAgent"
                ],
                "dynamic_action_decision": "None"
            },
            "DataPreparationAgent": {
                "inputs": [
                    "clarified_requirements",
                    "identified_functions"
                ],
                "outputs": [
                    "data_preparation_steps"
                ],
                "prompt": "You are an expert in data preparation and manipulation. Based on the clarified requirements and identified functions, provide detailed instructions on how to prepare and manipulate the data so that it becomes appropriate for the functions to call. Include any necessary data transformations, cleaning, or formatting steps.",
                "next_action": [
                    "StepByStepInstructionAgent"
                ],
                "dynamic_action_decision": "None"
            },
            "StepByStepInstructionAgent": {
                "inputs": [
                    "clarified_requirements",
                    "identified_libraries",
                    "identified_functions",
                    "data_preparation_steps"
                ],
                "outputs": [
                    "expanded_query"
                ],
                "prompt": "You are an expert in writing detailed instructions. Based on the outputs from the previous agents, compile a step-by-step guide on how to write Python code to fulfill the user query's requirements. Ensure that the instructions are clear, detailed, and executable, covering all aspects from importing libraries to generating the desired output.",
                "next_action": [
                    "END"
                ],
                "dynamic_action_decision": "None"
            }
        }
    }
}